!function(t){function r(t){if("number"==typeof t)return t.toString();var r={"<":"lt",">":"gt",'"':"quot","'":"apos"};for(var e in r)t=t.replace(new RegExp(e,"g"),"&"+r[e]+";");return t}function e(t,r){var e,n=[],a="undefined";if("undefined"!=typeof t.unshift){var i=t.length;for(e=0;i>e;e++)if(typeof t[e]!=a){var s=r.call(this,t[e],e);null!==s&&n.push(s)}}else for(e in t)if(t.hasOwnProperty(e)){var s=r.call(this,t[e],e);null!==s&&n.push(s)}return n}function n(t,r,e){for(var n in t)t.hasOwnProperty(n)&&(e=r.call(this,e,t[n],n));return e}function a(n,a,i,s){return"undefined"!=typeof s&&null!==s||(s=""),"object"==typeof a&&(a=e(a,function(e,n){switch(n){case"transform":return;case"fill":if(e.match(/^hsb/)){var a=e.replace(/^hsb\(|\)$/g,"").split(",");3===a.length&&(e=t.hsb2rgb(a[0],a[1],a[2]).toString())}}return n+'="'+r(e)+'"'}).join(" ")),"<"+n+(i?' transform="matrix('+i.toString().replace(/^matrix\(|\)$/g,"")+')" ':" ")+a+">"+s+"</"+n+">"}function s(t){return{font:{family:"undefined"==typeof t.attrs.font?null:t.attrs.font.replace(/^.?"(\w+)".$/,"$1"),size:"undefined"==typeof t.attrs["font-size"]?null:parseInt(t.attrs["font-size"]),style:"undefined"==typeof t.attrs["font-style"]?null:t.attrs["font-style"],weight:"undefined"==typeof t.attrs["font-weight"]?null:t.attrs["font-weight"]},anchor:"undefined"==typeof t.attrs["text-anchor"]?null:t.attrs["text-anchor"]}}function o(t){var r="normal",e="text-anchor: "+(t.anchor||"middle")+"; ",n=t.font;return e+["font:",n.style||r,r,n.weight||r,(n.size?n.size+"px":"10px")+"/normal",n.family].join(" ")}function l(t){return/^[0-9A-F]{6}$/i.test(t)&&(t="#"+t),t}function f(t,r,e){return null===t&&(t=10),4.5*t/13*(r-.2-e/2)*3.5}var c={text:function(t){var i=s(t),c=new Array,u=t.attrs.text.toString().split("\n"),p=u.length;return e(u,function(e,s){var u=n(t.attrs,function(t,e,n){return"text"!==n&&"w"!==n&&"h"!==n&&("font-size"===n&&(e=parseInt(e)+"px"),"stroke"===n&&(e=l(e)),t[n]=r(e.toString())),t},{style:o(i)+";"});""!=t.node.className.baseVal&&(u["class"]=t.node.className.baseVal),c.push(a("text",u,t.matrix,a("tspan",{dy:f(i.font.size,s+1,p)},null,e.replace(/&/g,"&amp;"))))}),c},path:function(t){1===t.matrix.a&&1===t.matrix.d?{}:{transform:t.matrix.toString()};return a("path",n(t.attrs,function(t,r,e){return"path"===e&&(e="d"),"stroke"===e&&(r=l(r)),t[e]=r.toString(),t},{}),t.matrix)}};t.fn.toSVG=function(){var e=this,n={svg:t.svg,vml:t.vml},a='<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e.width+'" version="1.1" height="'+e.height+'">';t.svg=!0,t.vml=!1;for(var s=e.bottom;null!=s;s=s.next)if("none"!==s.node.style.display){var o="";if("function"!=typeof c[s.type]){switch(s.type){case"image":o+=' preserveAspectRatio="none"'}for(i in s.attrs){var f=i,u="";switch(i){case"r":if("rect"!=s.type)break;u=s.attrs.r,s.attrs.rx=u,s.attrs.ry=u;continue;case"src":f="xlink:href";break;case"transform":f="";break;case"fill":if(s.attrs.gradient)continue;break;case"gradient":var p=s.id,d=s.attrs.gradient,h=.5,g=.5;if(d=String(d).replace(t._radial_gradient,function(t,r,e){if(type="radial",r&&e){h=parseFloat(r),g=parseFloat(e);var n=2*(g>.5)-1;Math.pow(h-.5,2)+Math.pow(g-.5,2)>.25&&(g=Math.sqrt(.25-Math.pow(h-.5,2))*n+.5)&&.5!=g&&(g=g.toFixed(5)-1e-5*n)}return""}),d=d.split(/\s*\-\s*/),s.attrs.gradient.match(/^r/g)){var v=t._parseDots(d);if(!v)continue;a+="<defs>",a+='	    <radialGradient id="radialgradient'+p+'" fx="'+h+'" fy="'+g+'" >';for(var m=0;m<v.length;m++){var y=m/(v.length-1)*100+"%";v[m].offset&&(y=v[m].offset),a+='<stop stop-color="'+v[m].color+'" offset="'+y+'"/>'}a+="    </radialGradient>",a+="</defs>",f="fill",u="url(#radialgradient"+p+")"}else{var x=d.shift();if(x=-1*parseFloat(x),isNaN(x))continue;var v=t._parseDots(d);if(!v)continue;var w=[0,0,Math.cos(t.rad(x)),Math.sin(t.rad(x))],b=1/(Math.max(Math.abs(w[2]),Math.abs(w[3]))||1);w[2]*=b,w[3]*=b,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0),a+="<defs>",a+='	    <linearGradient id="lineargradient'+p+'" x1="'+w[0]+'" y1="'+w[1]+'" x2="'+w[2]+'" y2="'+w[3]+'">';for(var m=0;m<v.length;m++){var y=m/(v.length-1)*100+"%";v[m].offset&&(y=v[m].offset),a+='<stop stop-color="'+v[m].color+'" offset="'+y+'"/>'}a+="    </linearGradient>",a+="</defs>",f="fill",u="url(#lineargradient"+p+")"}break;case"stroke":u=l(u?u:s.attrs[i].toString())}f&&(o+=u?" "+f+'="'+r(u)+'"':" "+f+'="'+r(s.attrs[i].toString())+'"')}""!=s.node.className.baseVal&&(o+=' class="'+s.node.className.baseVal+'"'),a+="<"+s.type+' transform="matrix('+s.matrix.toString().replace(/^matrix\(|\)$/g,"")+')"'+o+"></"+s.type+">"}else a+=c[s.type](s)}return a+="</svg>",t.svg=n.svg,t.vml=n.vml,a}}(window.Raphael);